{"template":{"$schema":"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{},"variables":{},"resources":[{"type":"Microsoft.Network/networkSecurityGroups","apiVersion":"2023-04-01","name":"hyper-v-nsg","location":"centralindia","properties":{"securityRules":[{"name":"RDP","id":"[resourceId('Microsoft.Network/networkSecurityGroups/securityRules', 'hyper-v-nsg', 'RDP')]","type":"Microsoft.Network/networkSecurityGroups/securityRules","properties":{"protocol":"TCP","sourcePortRange":"*","destinationPortRange":"3389","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":300,"direction":"Inbound","sourcePortRanges":[],"destinationPortRanges":[],"sourceAddressPrefixes":[],"destinationAddressPrefixes":[]}}]}},{"type":"Microsoft.Network/networkSecurityGroups","apiVersion":"2023-04-01","name":"ubuntu-nsg","location":"centralindia","properties":{"securityRules":[{"name":"SSH","id":"[resourceId('Microsoft.Network/networkSecurityGroups/securityRules', 'ubuntu-nsg', 'SSH')]","type":"Microsoft.Network/networkSecurityGroups/securityRules","properties":{"protocol":"TCP","sourcePortRange":"*","destinationPortRange":"22","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":300,"direction":"Inbound","sourcePortRanges":[],"destinationPortRanges":[],"sourceAddressPrefixes":[],"destinationAddressPrefixes":[]}}]}},{"type":"Microsoft.Network/publicIPAddresses","apiVersion":"2023-04-01","name":"hyper-v-ip","location":"centralindia","sku":{"name":"Standard","tier":"Regional"},"properties":{"ipAddress":"20.204.90.203","publicIPAddressVersion":"IPv4","publicIPAllocationMethod":"Static","idleTimeoutInMinutes":4,"ipTags":[]}},{"type":"Microsoft.Network/publicIPAddresses","apiVersion":"2023-04-01","name":"ubuntu-ip","location":"centralindia","sku":{"name":"Standard","tier":"Regional"},"properties":{"ipAddress":"52.172.236.191","publicIPAddressVersion":"IPv4","publicIPAllocationMethod":"Static","idleTimeoutInMinutes":4,"ipTags":[]}},{"type":"Microsoft.Network/virtualNetworks","apiVersion":"2023-04-01","name":"hyper-v-vnet","location":"centralindia","properties":{"addressSpace":{"addressPrefixes":["10.0.0.0/16"]},"subnets":[{"name":"default","id":"[resourceId('Microsoft.Network/virtualNetworks/subnets', 'hyper-v-vnet', 'default')]","properties":{"addressPrefix":"10.0.0.0/24","delegations":[],"privateEndpointNetworkPolicies":"Disabled","privateLinkServiceNetworkPolicies":"Enabled"},"type":"Microsoft.Network/virtualNetworks/subnets"}],"virtualNetworkPeerings":[],"enableDdosProtection":false}},{"type":"Microsoft.Compute/virtualMachines","apiVersion":"2023-03-01","name":"hyper-v","location":"centralindia","dependsOn":["[resourceId('Microsoft.Network/networkInterfaces', 'hyper-v917')]"],"properties":{"hardwareProfile":{"vmSize":"Standard_D4s_v3"},"storageProfile":{"imageReference":{"publisher":"MicrosoftWindowsServer","offer":"WindowsServer","sku":"2022-datacenter","version":"latest"},"osDisk":{"osType":"Windows","name":"hyper-v_OsDisk_1_7b983307bde74aebbe2bb3dfadf6cd3a","createOption":"FromImage","caching":"ReadWrite","managedDisk":{"id":"[resourceId('Microsoft.Compute/disks', 'hyper-v_OsDisk_1_7b983307bde74aebbe2bb3dfadf6cd3a')]"},"deleteOption":"Detach"},"dataDisks":[]},"osProfile":{"computerName":"hyper-v","adminUsername":"clouduser","windowsConfiguration":{"provisionVMAgent":true,"enableAutomaticUpdates":true,"patchSettings":{"patchMode":"AutomaticByOS","assessmentMode":"ImageDefault","enableHotpatching":false},"enableVMAgentPlatformUpdates":false},"secrets":[],"allowExtensionOperations":true,"requireGuestProvisionSignal":true},"networkProfile":{"networkInterfaces":[{"id":"[resourceId('Microsoft.Network/networkInterfaces', 'hyper-v917')]","properties":{"deleteOption":"Detach"}}]},"diagnosticsProfile":{"bootDiagnostics":{"enabled":true}},"licenseType":"Windows_Server"}},{"type":"Microsoft.Compute/virtualMachines","apiVersion":"2023-03-01","name":"ubuntu","location":"centralindia","dependsOn":["[resourceId('Microsoft.Network/networkInterfaces', 'ubuntu243')]"],"properties":{"hardwareProfile":{"vmSize":"Standard_D2s_v3"},"storageProfile":{"imageReference":{"publisher":"canonical","offer":"0001-com-ubuntu-server-focal","sku":"20_04-lts-gen2","version":"latest"},"osDisk":{"osType":"Linux","name":"ubuntu_OsDisk_1_7056d13ede094ff38ba2ee8d26fcffa8","createOption":"FromImage","caching":"ReadWrite","managedDisk":{"storageAccountType":"StandardSSD_LRS","id":"[resourceId('Microsoft.Compute/disks', 'ubuntu_OsDisk_1_7056d13ede094ff38ba2ee8d26fcffa8')]"},"deleteOption":"Delete","diskSizeGB":30},"dataDisks":[],"diskControllerType":"SCSI"},"osProfile":{"computerName":"ubuntu","adminUsername":"clouduser","linuxConfiguration":{"disablePasswordAuthentication":false,"provisionVMAgent":true,"patchSettings":{"patchMode":"ImageDefault","assessmentMode":"ImageDefault"},"enableVMAgentPlatformUpdates":false},"secrets":[],"allowExtensionOperations":true,"requireGuestProvisionSignal":true},"networkProfile":{"networkInterfaces":[{"id":"[resourceId('Microsoft.Network/networkInterfaces', 'ubuntu243')]","properties":{"deleteOption":"Detach"}}]},"diagnosticsProfile":{"bootDiagnostics":{"enabled":true}}}},{"type":"microsoft.devtestlab/schedules","apiVersion":"2018-09-15","name":"shutdown-computevm-ubuntu","location":"centralindia","dependsOn":["[resourceId('Microsoft.Compute/virtualMachines', 'ubuntu')]"],"properties":{"status":"Enabled","taskType":"ComputeVmShutdownTask","dailyRecurrence":{"time":"1900"},"timeZoneId":"UTC","notificationSettings":{"status":"Enabled","timeInMinutes":30,"emailRecipient":"saketh.yeminedi@cloud4c.com","notificationLocale":"en"},"targetResourceId":"[resourceId('Microsoft.Compute/virtualMachines', 'ubuntu')]"}},{"type":"Microsoft.Network/networkSecurityGroups/securityRules","apiVersion":"2023-04-01","name":"hyper-v-nsg/RDP","dependsOn":["[resourceId('Microsoft.Network/networkSecurityGroups', 'hyper-v-nsg')]"],"properties":{"protocol":"TCP","sourcePortRange":"*","destinationPortRange":"3389","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":300,"direction":"Inbound","sourcePortRanges":[],"destinationPortRanges":[],"sourceAddressPrefixes":[],"destinationAddressPrefixes":[]}},{"type":"Microsoft.Network/networkSecurityGroups/securityRules","apiVersion":"2023-04-01","name":"ubuntu-nsg/SSH","dependsOn":["[resourceId('Microsoft.Network/networkSecurityGroups', 'ubuntu-nsg')]"],"properties":{"protocol":"TCP","sourcePortRange":"*","destinationPortRange":"22","sourceAddressPrefix":"*","destinationAddressPrefix":"*","access":"Allow","priority":300,"direction":"Inbound","sourcePortRanges":[],"destinationPortRanges":[],"sourceAddressPrefixes":[],"destinationAddressPrefixes":[]}},{"type":"Microsoft.Network/virtualNetworks/subnets","apiVersion":"2023-04-01","name":"hyper-v-vnet/default","dependsOn":["[resourceId('Microsoft.Network/virtualNetworks', 'hyper-v-vnet')]"],"properties":{"addressPrefix":"10.0.0.0/24","delegations":[],"privateEndpointNetworkPolicies":"Disabled","privateLinkServiceNetworkPolicies":"Enabled"}},{"type":"Microsoft.Network/networkInterfaces","apiVersion":"2023-04-01","name":"hyper-v917","location":"centralindia","dependsOn":["[resourceId('Microsoft.Network/publicIPAddresses', 'hyper-v-ip')]","[resourceId('Microsoft.Network/virtualNetworks/subnets', 'hyper-v-vnet', 'default')]","[resourceId('Microsoft.Network/networkSecurityGroups', 'hyper-v-nsg')]"],"kind":"Regular","properties":{"ipConfigurations":[{"name":"ipconfig1","id":"[concat(resourceId('Microsoft.Network/networkInterfaces', 'hyper-v917'), '/ipConfigurations/ipconfig1')]","etag":"W/\"4889d0d6-6ef9-4fe7-93e5-c2e798ba1435\"","type":"Microsoft.Network/networkInterfaces/ipConfigurations","properties":{"provisioningState":"Succeeded","privateIPAddress":"10.0.0.4","privateIPAllocationMethod":"Dynamic","publicIPAddress":{"id":"[resourceId('Microsoft.Network/publicIPAddresses', 'hyper-v-ip')]","properties":{"deleteOption":"Detach"}},"subnet":{"id":"[resourceId('Microsoft.Network/virtualNetworks/subnets', 'hyper-v-vnet', 'default')]"},"primary":true,"privateIPAddressVersion":"IPv4"}}],"dnsSettings":{"dnsServers":[]},"enableAcceleratedNetworking":true,"enableIPForwarding":false,"disableTcpStateTracking":false,"networkSecurityGroup":{"id":"[resourceId('Microsoft.Network/networkSecurityGroups', 'hyper-v-nsg')]"},"nicType":"Standard","auxiliaryMode":"None","auxiliarySku":"None"}},{"type":"Microsoft.Network/networkInterfaces","apiVersion":"2023-04-01","name":"ubuntu243","location":"centralindia","dependsOn":["[resourceId('Microsoft.Network/publicIPAddresses', 'ubuntu-ip')]","[resourceId('Microsoft.Network/virtualNetworks/subnets', 'hyper-v-vnet', 'default')]","[resourceId('Microsoft.Network/networkSecurityGroups', 'ubuntu-nsg')]"],"kind":"Regular","properties":{"ipConfigurations":[{"name":"ipconfig1","id":"[concat(resourceId('Microsoft.Network/networkInterfaces', 'ubuntu243'), '/ipConfigurations/ipconfig1')]","etag":"W/\"70d11cb8-8942-476b-8306-7ea614061c6e\"","type":"Microsoft.Network/networkInterfaces/ipConfigurations","properties":{"provisioningState":"Succeeded","privateIPAddress":"10.0.0.5","privateIPAllocationMethod":"Dynamic","publicIPAddress":{"id":"[resourceId('Microsoft.Network/publicIPAddresses', 'ubuntu-ip')]","properties":{"deleteOption":"Detach"}},"subnet":{"id":"[resourceId('Microsoft.Network/virtualNetworks/subnets', 'hyper-v-vnet', 'default')]"},"primary":true,"privateIPAddressVersion":"IPv4"}}],"dnsSettings":{"dnsServers":[]},"enableAcceleratedNetworking":true,"enableIPForwarding":false,"disableTcpStateTracking":false,"networkSecurityGroup":{"id":"[resourceId('Microsoft.Network/networkSecurityGroups', 'ubuntu-nsg')]"},"nicType":"Standard","auxiliaryMode":"None","auxiliarySku":"None"}}]}}